<launch>
    <arg name="frame_prefix" default=""/>
    <arg name="odom_frame" default="$(arg frame_prefix)odom"/>
    <arg name="base_frame" default="$(arg frame_prefix)base_footprint"/>
    <arg name="map_frame" default="/$(arg frame_prefix)map"/>

    <node pkg="rtabmap_ros" type="rtabmap" name="rtabmap" output="screen">
        <!-- Disabilita le sottoscrizioni non necessarie -->
        <param name="subscribe_depth" value="false"/>
        <param name="subscribe_rgb" value="false"/>
        <param name="subscribe_stereo" value="false"/>
        <param name="subscribe_scan" value="false"/>

        <!-- Abilita la sottoscrizione al point cloud del LIDAR -->
        <param name="subscribe_scan_cloud" value="true"/>
        <!-- Rimuovi il parametro scan_cloud_topic, utilizzeremo il remapping -->

        <!-- Configurazione dei frame -->
        <param name="frame_id" value="$(arg base_frame)"/>
        <param name="odom_frame_id" value="$(arg odom_frame)"/>
        <param name="map_frame_id" value="$(arg map_frame)"/>

        <!-- Configurazione dell'odometria -->
        <param name="Odom/Strategy" value="0"/>

        <!-- Sincronizzazione approssimativa -->
        <param name="approx_sync" value="true"/>
	<param name="Grid/PublishOccupancyGrid" value="true"/>

        <!-- Remapping del topic -->
        <remap from="scan_cloud" to="/velodyne_points"/>
<remap from="grid_map" to="/map"/>
<remap from="grid_map" to="/map"/>

        <!-- Altri parametri di RTAB-Map (se necessari) -->
    </node>
</launch>

